<div class="col-lg-12">
<h1>
  <%= @user.tasks.public_tasks.count %> Projetos Público de 
  <% if @user.nome != "" %>
  <%= @user.nome %> <%= @user.sobrenome %>
  <% else %>
  <%= @user.email %>
  <% end %>
  <small>Acompanhamento de Tarefas  </small>
</h1>


  <div class="">
    <form action="#" method="get">
        <div class="input-group">
            <input class="form-control" id="system-search" name="q" autofocus="autofocus" placeholder="Pesquisar por Tarefas, Subtarefas, Status" required>
            <span class="input-group-btn">
                <button type="submit" class="btn btn-default">
                  <i class="fa fa-search"></i>
                </button>
            </span>
        </div>
    </form>
  </div> <br>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h4>Tarefas Públicas</h4>
  </div>
    <table class="table table-striped table table-list-search">
    <thead>
      <tr>
        <th class="col-md-3">Tarefa</th>
        <th class="col-md-2">Status</th>
        <th class="col-md-2">Subtarefas</th>
        <th class="col-md-1">Última Alteração</th>
        <th class="col-md-2">Criadas</th>

      </tr>
    </thead>
    <tbody>
      <% @user.tasks.each do |task| %>
      <tr>
        <td>
           <b><%= task.content %></b> <br>
           <p><%= task.descricao %></p>
        
        <% if task.url.present? %>  
        <div class="input-group">
          <input type="text" class="form-control" placeholder="<%= task.url %>" aria-describedby="basic-addon2"  value="<%= task.url %>">
          <span class="input-group-addon" id="basic-addon2">
            <%= link_to task.url, target: "_blank" do %>
            <i class="fa fa-external-link"></i>
            <% end -%>
          </span>
        </div>
        <% end -%>
      </td>
      <td> 
        <% if task.state == "done" %>
        <span class="label label-success">Finalizado</span>
        <% elsif task.state == "doing" %>
        <span class="label label-warning">Fazendo</span>
        <% else  %>
        <span class="label label-danger">Fazer</span>
        <% end %> <br>


      </td>
      <td>
        <ol id="selector">
          <% task.subtasks.each do |subtask| %>
          <div class="subtask-title">
              <% if subtask.work?  %>
              <span class="icon"><i class="laranjaicon fa fa-refresh fa-spin"></i></span>
              <% elsif subtask.complete? %>
              <span class="icon "><i class="verdeicon fa fa-check fa-1x"></i></span>
              <% else %>
              <span class="icon">&#9417;</span>
              <% end %> 
              <span><%= subtask.name %> </span>
              <% if !subtask.logs.empty? %>
              <!-- <span class="show-logs">&#8609;</span> -->
              <% end %>
          <div class="subtask-logs logs-<%=subtask.id %>">
            <%= render subtask.logs %>
          </div>
          </div>
          <% end -%>
        </ol>
      </td>

      <td>
        <%= time_ago_in_words(task.updated_at) %>
      </td>
      <td>
        <%= time_ago_in_words(task.created_at) %>
      </td>
    </tr>
    <% end %>
    </tbody>
    </table>
</div>
